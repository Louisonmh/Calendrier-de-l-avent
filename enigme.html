<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Surprise !</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="snow"></div>

    <div class="container">
        <div class="riddle-card">
            <h2 id="day-title">Jour ...</h2>
            
            <div id="media-container" style="margin-bottom: 20px;"></div>
            
            <p id="riddle-text">Chargement...</p>

            <div id="input-zone" class="input-group">
                <input type="text" id="user-answer" placeholder="Ta r√©ponse ici..." autocomplete="off">
                <button class="btn" onclick="checkAnswer()" style="margin-top:0;">Valider</button>
                <p id="error-message" class="error-msg">Mauvaise r√©ponse, essaie encore ! ‚ùå</p>
            </div>

            <button id="action-btn" class="btn" onclick="handleAction()" style="background-color: var(--secondary-color);">Voir la solution</button>
            
            <div id="solution" style="display:none; margin-top:20px; border-top: 1px solid #ddd; padding-top:20px;">
                <p id="solution-text" style="color: var(--primary-color); font-weight:bold; font-size: 1.2rem;"></p>
                <div id="reward-media"></div>
            </div>

            <br><br>
            <a href="index.html" class="btn" style="background-color: #7f8c8d; font-size: 0.8rem;">‚¨Ö Retour au calendrier</a>
        </div>
    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const day = params.get('jour');

        // --- TA CONFIGURATION ---
        const riddles = {
            // EXEMPLE 1 : Question avec R√©ponse Obligatoire
            1: {
                text: "BAHAHAHAH j'espere tes choqu√© ! Voici ton premier defi, d'ailleur j'ai sign√© l'appartement ! reviens demain :)",
                image: "./img/Jour1.png",
                url: "https://www.jigsawplanet.com/?rc=play&pid=1de7c9e6df69",
                buttonText: "Faire le Puzzle üß©"
            },

            // EXEMPLE 2 : Puzzle / Lien externe
            2: {
                text: "Je commence par un B, je finis par un R. Je suis humide, chaud, et tu adores quand je suis intense. Qui suis-je ?",
                code: "un baiser",
                solution: "Bravo ! A demain !"
            },

            // EXEMPLE 3 : Classique (Bouton r√©v√©lation)
            3: {
                text: "01010100 00100111 01100101 01110011 00100000 01100010 01100101 01100001 01110101 <br> Bon courage",
                code: "T'es beau",
                solution: "Ehh ta finis de me draguer ! A demain"
            },
            4: {
                text: "Petite devinette : Qu'est-ce qui a 13 coeurs mais aucun autre organe ?",
                solution: "Un jeu de cartes ! (On joue ce soir ?)"
            }
        };

        // --- LOGIQUE (NE PAS TOUCHER) ---
        const content = riddles[day];
        
        // √âl√©ments HTML
        const titleEl = document.getElementById('day-title');
        const textEl = document.getElementById('riddle-text');
        const solContainer = document.getElementById('solution');
        const solText = document.getElementById('solution-text');
        const inputZone = document.getElementById('input-zone');
        const actionBtn = document.getElementById('action-btn');
        const errorMsg = document.getElementById('error-message');
        const inputField = document.getElementById('user-answer');
        const mediaEl = document.getElementById('media-container');

        if (content) {
            titleEl.innerText = `Jour ${day}`;
            textEl.innerHTML = content.text;

            // Gestion Image Principale
            if (content.image) {
                mediaEl.innerHTML = `<img src="${content.image}" style="max-width:100%; border-radius:10px;">`;
            }

            // MODE 1 : Il y a un CODE √† trouver
            if (content.code) {
                actionBtn.style.display = 'none'; // Cache le gros bouton
                inputZone.style.display = 'block'; // Affiche le champ texte
            }
            // MODE 2 : C'est un LIEN
            else if (content.url) {
                actionBtn.innerText = content.buttonText || "Ouvrir le lien";
            }
            // MODE 3 : Classique
            else {
                actionBtn.innerText = "Voir la r√©ponse";
            }

        } else {
            titleEl.innerText = "Oups";
            textEl.innerText = "Pas d'√©nigme pour ce jour.";
            actionBtn.style.display = 'none';
        }

        // Fonction pour valider la r√©ponse √©crite
        function checkAnswer() {
            const userRep = inputField.value.toLowerCase().trim(); // On met en minuscule et on enl√®ve les espaces
            const correctRep = content.code.toLowerCase().trim();

            if (userRep === correctRep) {
                // VICTOIRE
                inputZone.style.display = 'none'; // Cache le champ
                solContainer.style.display = 'block'; // Affiche la solution
                solText.innerHTML = content.solution;
                createConfettis(); // Bonus : petite animation si tu veux
            } else {
                // ERREUR
                errorMsg.style.display = 'block';
                inputField.style.border = "2px solid red";
            }
        }

        // Fonction du bouton principal (Lien ou R√©v√©lation)
        function handleAction() {
            if (content.url) {
                window.open(content.url, '_blank');
            } else {
                solContainer.style.display = 'block';
                solText.innerHTML = content.solution;
                actionBtn.style.display = 'none'; // Cache le bouton apr√®s clic
            }
        }
        
        // Bonus : Permet de valider avec la touche "Entr√©e"
        inputField.addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                checkAnswer();
            }
        });

    </script>
</body>
</html>